# Сервис а-ля Pastebin
Сервис для хранения текста, с доступом к редактированию по токенам без авторизации
## Как запустить
* docker-compose up
* зайти в контейнер постгреса через docker exec -it psql с кредами и параметрами из docker-compose
* Выполнить команды из init.sql
* Можно посылать запросы к серверу
*  Swagger UI с описаниям ендпоинтов на /docs

## Функционал
* Просмотр существующих записей (pastein) через /pastein/\<shorthand>
* Создание новых записей через post на pastein/. Помимо текста записи 
опционально можно передать access_token, по которому она будет доступна для 
редактирования. Если токен не будет передан, он сгенерируется автоматически 
и будет возвращен вместе с выделенным для записи ссылкой-shorthand.
Генерируемые токены не превышают где-то 12 знаков, пользовательские
обрезаются на 15. 
* Проверка доступа к редактированию записи через get на /verify.
  (Передается shorthand и токен, возвращается boolean)
* Редактирование записи через put на /pastein/\<shorthand> 
  
    
Удаления записей нет, потому что в контексте расшаренного текста не особо 
понятно зачем. Поддерживается время последнего обращения к записи на 
просмотр/создание/редактирование, в принципе можно просто сколько-нибудь 
регулярно чистить бд на предмет достаточно невостребованных записей.
В условиях отсутствия авторизации и привелигированных пользователей, делать
это имеет смысл напрямую с бд.

Для потенциальных логов поддерживается требование X-Request-Id в хэдере
всех запросов, только костыльно выключил его для просмотра записей чтобы 
можно было нормально в браузере открывать.

## Ожидаемый формат использования
* Доступ к просмотру записей по уникальной ссылке, в это время фронтенд
логика, будь это JS или что-нибудь еще смотрит, сохранен ли у пользователя
токен, проверяет, можно ли по нему редактировать текущую запись, и если да, 
открывает поле на странице для редактирования. Ну и соотвественно при
сохранении изменений вызывается соответствующий запрос. 
* Создание новых записей на какой-нибудь выделенной для этого странице,
после этого JS посылает запрос, получает ссылку и токен, сохраняет его и
перенаправляет пользователя по ссылке.

Просмотр записи как операции полупользовательская ошибок не
бросает и просто возвращает Option[PasteinBody]. Попытки обращения к другим 
ендпоинтам по несуществующим ссылкам выбрасывают соответствующие ошибки.